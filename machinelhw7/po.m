
a = [0.5, 0.5; 0.4, 0.6]; p = [0.5; 0.5];  
b = [0.2, 0.3, 0.3, 0.2; 0.3, 0.2, 0.2, 0.3];
o = [3, 3, 2, 1];

alpha(:, 1) = b(:, o(1)) .* p; 
for i = 2: 4
  alpha(:, i) = b(:, o(i)) .* (a' * alpha(:, i - 1)); 
end
