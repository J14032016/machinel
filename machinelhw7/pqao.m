
a = [0.5, 0.5; 0.4, 0.6]; p = [0.5; 0.5];  
b = [0.2, 0.3, 0.3, 0.2; 0.3, 0.2, 0.2, 0.3];
o = [3, 3, 2, 1, 2, 4, 3, 1, 1];

warning('off');
d(:, 1) = b(:, o(1)) .* p;
for i = 2: 9
  [d(:, i), im]  = max(b(:, o(i))' .* a .* d(:, i - 1));
end
